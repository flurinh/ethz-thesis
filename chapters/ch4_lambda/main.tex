\chapter{LAMBDA --- Cross-Family Spectral Prediction}
\label{ch:lambda}

\dictum{%
  What do a Honduran yellow-shouldered bat and a beluga whale have in common?}%
\vskip 1em

\chapterabstract{}
LAMBDA (Light Absorption Modeling through Binding Domain Analysis) is a graph neural network that predicts opsin absorption maxima from binding pocket composition. It predicts $\lambda_\text{max}$ across any retinal-binding fold---Type~I, Type~II, and engineered proteins like hCRBPII---using binding domain analysis rather than family-specific regression. It predicts multiple $\lambda_\text{max}$ values simultaneously (for different forms of retinal: 11-\textit{cis}, all-\textit{trans}, protonated, deprotonated), enabling estimation of spectral shifts between chromophore states. As GRN-annotated sequences are sufficient input, LAMBDA scales to tens of thousands of predictions without requiring structures. These capabilities serve three applications: the Opsin Atlas (47,700 sequences), engineering of spectral properties through binding pocket mutations, and understanding how retinal-binding pockets might be incorporated into synthetic folds.


\section{Introduction}
\label{sec:lambda-introduction}

Optogenetics depends on matching light wavelength to protein response. Type~I (microbial) opsins provide the ion channels and pumps that enable neural activation and silencing\cite{deisseroth2015}\cite{kato2016}. Type~II (animal) opsins underlie visual neuroscience and increasingly serve as light-activated GPCRs for controlling intracellular signaling\cite{Koyanagi2014}. In both cases, the absorption maximum $\lambda_\text{max}$ determines which wavelengths activate the protein, and selecting or engineering opsins with specific $\lambda_\text{max}$ values is a core challenge. Red-shifted opsins ($\lambda_\text{max} > \SI{580}{\nano\metre}$) enable deeper tissue penetration because longer wavelengths scatter less in biological tissue. Spectrally separated pairs---one blue-absorbing, one red-absorbing---allow multiplexed control of distinct cell populations in the same preparation\cite{berndt2009}. Many optogenetic applications also require a distinct off-switch: bistable opsins can be both photoactivated and photoreversed, but this bidirectional control requires sufficient separation between dark-state and activated-state absorption maxima. If the two states absorb at similar wavelengths, a single light source drives both forward and reverse photoreactions, precluding selective control. Predicting $\lambda_\text{max}$ for both chromophore states of the same protein, and the spectral gap between them, is therefore also important.

Beyond opsins, engineered systems demonstrate that retinal can be bound and spectrally tuned in protein folds entirely unrelated to opsins. Human cellular retinol binding protein~II (hCRBPII)\cite{wang2012} is the clearest example: As protein engineering capabilities grow---through directed evolution, computational design, and de~novo fold generation---the prospect of incorporating retinal-binding pockets into novel protein scaffolds creates the possibility of coupling light activation to functions beyond the ion transport, channel gating, and GPCR signaling that natural opsins provide. Understanding how binding pocket architecture determines spectral properties, independent of global fold, is a prerequisite for this direction.

Light absorption follows the relationship $E = hc/\lambda$: a photon is absorbed when its energy matches the gap between electronic states of the chromophore. The protein environment tunes this gap through electrostatic interactions with the conjugated polyene chain of retinal. The counterion\cite{kandori2020}---a negatively charged residue \SIrange{3}{4}{\angstrom} from the protonated Schiff base---is the primary determinant, but the entire network of binding pocket residues contributes, and single mutations at key positions can shift $\lambda_\text{max}$ by \SI{10}{\nano\metre} to \SI{40}{\nano\metre}\cite{honig1979}. All retinal-binding proteins use the same chromophore yet span $\lambda_\text{max}$ values from ${\sim}\SI{350}{\nano\metre}$ (UV) to ${\sim}\SI{650}{\nano\metre}$ (far-red), with the variation arising along two independent axes: geometric isomerism and protonation state. Type~II opsins bind 11-\textit{cis} retinal in the dark state; type~I opsins and photoactivated type~II opsins bind all-\textit{trans} retinal. Independently, the Schiff base linkage to the conserved lysine can be protonated (the dominant state for most opsins, absorbing in the visible range) or deprotonated (as in UV-sensitive SWS1 opsins, which bind 11-\textit{cis} retinal but absorb below \SI{400}{\nano\metre}).  Both properties---isomer state and protonation---are determined by the same binding pocket environment (\autoref{fig:spectral-tuning-overview}). Because energy is inversely proportional to wavelength, spectral tuning becomes increasingly difficult to resolve at long wavelengths.

\begin{sidewaysfigure}
  \centering
  \includegraphics[width=\textheight]{\dir/fig_spectral_tuning_overview.jpg}
  \caption[Spectral tuning in opsins]{%
    Spectral tuning in opsins.
    (A)~The relationship between energy gap and absorption wavelength ($E = hc/\lambda$). Equal wavelength differences correspond to smaller energy differences at longer wavelengths (see main text).
    (B)~Retinal Schiff base configurations: 11-\textit{cis} protonated (dark state in type~II opsins), all-\textit{trans} protonated (type~I opsins and activated type~II), and deprotonated (UV-sensitive opsins).
    (C,D)~Distribution of experimentally measured $\lambda_\text{max}$ values for 11-\textit{cis} and all-\textit{trans} retinal across the training datasets.}
  \label{fig:spectral-tuning-overview}
\end{sidewaysfigure}

Tens of thousands of opsin sequences exist in databases, but fewer than 3,000 have measured $\lambda_\text{max}$ values. Existing computational methods---OPTICS\cite{frazer2024}, the Inoue model\cite{karasuyama2018}, RhoMax\cite{sela2024}---achieve reasonable accuracy within their respective domains (\autoref{ch:introduction}), but they share two fundamental limitations: they are fold-specific (none can predict across both opsin families or handle retinal-binding proteins with different folds) and they predict only a single $\lambda_\text{max}$ for their target family's native chromophore state (i.e., they are unable to predict activated states, deprotonated states, or the spectral gap between chromophore states that determines whether bidirectional control is feasible).

LAMBDA addresses these limitations by framing spectral prediction as a question about binding pockets rather than sequences. The same pocket representation implicitly encodes the chromophore environment for different retinal conformations---11-\textit{cis}, all-\textit{trans}, protonated, deprotonated---so the model predicts $\lambda_\text{max}$ for multiple states simultaneously from a single shared representation. Predicting both dark-state (11-\textit{cis}) and activated-state (all-\textit{trans}) absorption maxima for the same protein yields the spectral shift $\Delta\lambda$ between on and off states---a quantity that determines whether bidirectional optogenetic control is feasible and that no existing method can estimate.

Since spectral tuning is determined by the binding pocket, the natural representation for prediction is the pocket itself---the residues surrounding retinal and their spatial contacts---rather than the full protein sequence or the global fold. In LAMBDA, binding pockets are represented as graphs: nodes are binding pocket residues, edges encode spatial contacts between them. This topology captures which residues interact, independent of their sequence positions or the global architecture that places them there. \autoref{fig:pocket-structures-graphs} illustrates this across three structurally unrelated protein families. 

\begin{figure}[H]
  \centering
  \includegraphics[width=\textwidth]{\dir/fig_pocket_structures_graphs.jpg}
  \caption[Binding pocket structures and graph representations for three retinal-binding protein families]{%
    Binding pocket structures and graph representations for three retinal-binding protein families. Top: crystal structures with pocket residues shown as sticks. Bottom: corresponding contact graphs used as LAMBDA input.
    (A,~D)~Bacteriorhodopsin, Type~I opsin.
    (B,~E)~Bovine rhodopsin, Type~II opsin.
    (C,~F)~hCRBPII, a $\beta$-barrel protein.
    Opsin residues colored by transmembrane helix (TM1--TM7).}
  \label{fig:pocket-structures-graphs}
\end{figure}

Type~I opsins (bacteriorhodopsin, 1C3W) and type~II opsins (bovine rhodopsin, 1U19) are both seven-transmembrane alpha-helical bundles, but with independently evolved architectures---different helix tilts, loop connectivities, and retinal binding orientation---and no detectable sequence homology. hCRBPII (4QYP) adopts an entirely different fold---a $\beta$-barrel---yet engineered variants bind retinal and span over \SI{200}{\nano\metre} of spectral tuning through only nine point mutations. Despite these architectural differences, the graph representation reduces each binding pocket to the same format: nodes are residues within contact distance of retinal, edges encode spatial adjacency within \SI{4}{\angstrom}. The opsin graphs have similar sizes (68 and 69 nodes); the hCRBPII graph has comparable complexity (67 nodes). The same model architecture processes all three graph types, learning spectral tuning determinants from binding pocket composition regardless of the surrounding protein scaffold.

A binding pocket graph derived from a crystal structure is the definitive representation, but structures exist for only a fraction of known opsins. GRN annotation (\autoref{ch:mogrn}) is what makes the approach scalable: a sequence annotated with GRN coordinates maps directly onto the family's reference binding graph topology. GRN tells us which pocket positions are present and where they sit relative to retinal, so binding pocket graphs can be constructed from sequence alone---no structure required. Aligning reference structures from both families on retinal reveals that certain positions occupy equivalent spatial locations relative to the chromophore: position~7.43 (type~II) and~7.50 (type~I) are both the Schiff base lysine; 3.28 and~3.57 are both in the counterion region. Treating mapped positions as equivalent graph nodes enables cross-family learning despite the independent evolutionary origins of these folds. Protein language model embeddings from Ankh-large\cite{elnaggar2023ankh}, chosen for its balance of embedding quality and computational efficiency, provide 1536-dimensional per-residue feature vectors that serve as node features, encoding amino acid identity and evolutionary context. Both GRN annotation and pLM embeddings require only a protein sequence as input.

\begin{figure}[H]
  \centering
  \includegraphics[width=\textwidth]{\dir/fig_data_flow.jpg}
  \caption[Data flow for binding pocket graph construction]{%
    Data flow for the two binding pocket graph construction pathways. The structure-based path (top) processes any retinal-binding protein through Structure Processor $\to$ GRN annotation $\to$ Graph assembly. The sequence-only path (bottom) exploits conserved GRN systems to construct graphs directly from sequence via GRN annotation $\to$ graph topology lookup $\to$ embedding enrichment. Both paths produce the same graph format consumed by LAMBDA.}
  \label{fig:data-flow}
\end{figure}

There are two pathways to construct LAMBDA input graphs, depending on whether a structure is available (\autoref{fig:data-flow}). The structure-based path processes any retinal-binding protein with a known or predicted structure: binding pocket residues are identified based on proximity to retinal, GRN coordinates are assigned, per-residue pLM embeddings are computed, and the contact graph is assembled. The sequence-only path annotates the sequence with GRN positions, applies the family-specific binding pocket topology directly, and uses pLM embeddings as node features; this is the path used for the Opsin Atlas predictions on 47,700 sequences. Both paths produce the same output: a binding pocket graph where each node carries a positional encoding and a pLM embedding, and edges encode spatial contacts. A graph attention network learns the mapping from binding pocket composition to spectral properties, trained on 2,120 proteins with measured absorption values across three protein folds.


\section{Methods}
\label{sec:lambda-methods}


\subsection{Datasets}
\label{sec:lambda-datasets}

Training data were compiled from three sources that together span both opsin families and multiple retinal conformations.

\textbf{VPOD~1.3} (Visual Physiology Opsin Database) contains 1,253 type~II opsin sequences spanning vertebrate and invertebrate species. The dataset includes both wild-type and experimentally characterized mutant opsins, with $\lambda_\text{max}$ values for 11-\textit{cis} retinal ranging from \SIrange{350}{611}{\nano\metre}. VPOD provides the largest collection of animal opsin spectral data, spanning vertebrate visual opsins, invertebrate opsins, and non-visual opsins such as melanopsin.

\textbf{The Inoue dataset} expands coverage to type~I (microbial) opsins, containing 785 sequences from 30 species. These sequences were collected from NCBI, metagenomic databases, and the Tara Oceans project, with experimentally determined $\lambda_\text{max}$ values for all-\textit{trans} retinal. The dataset spans bacteriorhodopsins, halorhodopsins, channelrhodopsins, and sensory rhodopsins, with absorption maxima ranging from \SIrange{436}{644}{\nano\metre}.

To enable prediction of the all-\textit{trans} retinal state for type~II opsins, training data were augmented with activated-state $\lambda_\text{max}$ values collected from the literature. For 31 type~II opsins with reported photoactivated or meta-state absorption maxima, the all-\textit{trans} $\lambda_\text{max}$ was recorded alongside the dark-state (11-\textit{cis}) value. This approach is necessarily approximate: ``activated state'' encompasses different photointermediates depending on the opsin's photocycle (meta~II in visual opsins, the stable photoproduct in bistable opsins). Nevertheless, these dual-state annotations are suitable as ground truth for training the all-\textit{trans} prediction head on type~II opsins. These 31 opsins were assigned exclusively to the training split to maximize the model's exposure to dual-state measurements.

\textbf{hCRBPII} (human cellular retinol binding protein~II) represents an engineered system where Wang et~al.\ created retinal-binding variants through targeted mutations. This curated dataset of 51 sequences demonstrates spectral tuning spanning \SIrange{425}{644}{\nano\metre} with all-\textit{trans} retinal---a range of \SI{219}{\nano\metre} achieved through combinations of nine point mutations. hCRBPII adopts a lipocalin fold unrelated to opsins\cite{nossoni2014}, providing a test case for cross-fold generalization. As with Type~I and Type~II opsins, the hCRBPII binding pocket was aligned to retinal and equivalent positions mapped to the nearest GRN coordinates, enabling the same graph-based representation.

The distribution of measured $\lambda_\text{max}$ values across these datasets is shown in \autoref{fig:lambda-distributions}.

\begin{table}[tb]
  \caption[Training datasets for LAMBDA]{Training datasets for LAMBDA.}
  \label{tab:lambda-datasets}
  \centering
  \begin{tabular}{lrlll}
    \toprule
    Dataset & Samples & Fold & Retinal & $\lambda_\text{max}$ range (nm) \\
    \midrule
    VPOD~1.3 & 1,253 & Type~II & 11-\textit{cis} & 350--611 \\
    Inoue & 785 & Type~I & all-\textit{trans} & 436--644 \\
    Dual-state (this work) & 31 & Type~II & both & varies \\
    hCRBPII & 51 & Lipocalin & all-\textit{trans} & 425--644 \\
    \midrule
    \textbf{Total} & \textbf{2,120} & & & \\
    \bottomrule
  \end{tabular}
\end{table}

\begin{figure}[H]
  \centering
  \includegraphics[width=\textwidth]{\dir/fig_lambda_distributions.jpg}
  \caption[Distribution of measured $\lambda_\text{max}$ values across training datasets]{%
    Distribution of measured $\lambda_\text{max}$ values across training datasets.
    (A)~11-\textit{cis} retinal: VPOD~1.3 ($n=1{,}253$) and dual-state opsins ($n=31$).
    (B)~All-\textit{trans} retinal: Inoue dataset ($n=785$), dual-state opsins ($n=31$), and hCRBPII ($n=51$).}
  \label{fig:lambda-distributions}
\end{figure}

The diversity of these datasets---spanning different opsin types, species, and retinal conformations---necessitates a multi-output approach. Type~II opsins bind 11-\textit{cis} retinal in the dark state, while type~I opsins bind all-\textit{trans} retinal. The model addresses this by predicting $\lambda_\text{max}$ for multiple retinal states simultaneously, allowing it to learn shared spectral tuning principles while capturing conformation-specific effects. This creates an inherent asymmetry: the all-\textit{trans} prediction head is trained on type~I opsins (Inoue, $n=785$), hCRBPII ($n=51$), and the 31 dual-state type~II opsins, while the 11-\textit{cis} head is trained exclusively on type~II data (VPOD, $n=1{,}253$). The model does produce 11-\textit{cis} predictions for type~I opsins, but these are extrapolations with no training signal---type~I opsins natively bind all-\textit{trans} retinal, and predicting their absorption with 11-\textit{cis} or other isomers (9-\textit{cis}, 13-\textit{cis}) would require isomer-specific training data that does not currently exist at scale.


\subsection{Binding Pocket Graphs}
\label{sec:lambda-pocket-graphs}

Type~I (microbial) and Type~II (animal) opsins share no detectable sequence homology, yet both evolved seven-transmembrane architectures that bind retinal. LAMBDA exploits this convergence by representing binding pockets as graphs aligned on the chromophore itself. A single reference structure defines the binding pocket graph for each protein family: bovine rhodopsin (PDB: 1U19\cite{okada2004}) for type~II opsins and bacteriorhodopsin (PDB: 1C3W\cite{luecke1999}) for type~I opsins. Within each reference structure, binding pocket residues are identified as those with any sidechain atom within \SI{9}{\angstrom} of retinal. These residues become nodes in the graph. Edges connect residue pairs with atoms within \SI{4}{\angstrom} of each other, encoding the network of spatial contacts through the binding pocket.

To enable cross-family learning, the two reference structures are aligned on the retinal polyene chain (atoms C7--C15) using Kabsch superposition\cite{kabsch1976}. After alignment, binding pocket residues from both families that occupy equivalent spatial locations are identified through sidechain volume overlap: for each pair of GRN positions (one from each family) whose C$\alpha$ atoms fall within \SI{2}{\angstrom}, a voxelized sidechain overlap is computed, and pairs exceeding 15\% overlap of the smaller sidechain volume are mapped in a greedy one-to-one matching. This procedure yields 25 cross-family position pairs out of ${\sim}70$ binding pocket positions per family. Positions without a cross-family partner are retained as family-specific nodes. The Schiff base lysine (7x43 in type~II, 7x50 in type~I) is hardcoded as a mapped pair.

Mapped positions share graph node indices during training, enabling the model to learn that residues at equivalent spatial locations serve analogous roles in spectral tuning despite belonging to different protein folds. Unmapped positions contribute family-specific nodes that capture tuning determinants unique to each fold.


\subsection{Preprocessing}
\label{sec:lambda-preprocessing}

Generating binding pocket graphs for any opsin sequence without requiring experimental structures is achieved through Generic Residue Numbering (GRN) systems, which assign structural coordinates based on sequence alignment alone.

GRN systems label positions within transmembrane proteins using a standardized notation: the helix number followed by a position relative to a conserved reference residue (\eg 3x50 denotes position~50 in helix~3). For Type~II opsins, the established Ballesteros--Weinstein\cite{ballesteros1995} numbering system is used. For Type~I opsins, MOGRN\cite{hidber2026mogrn} is used, with reference positions (X.50) chosen as the residue closest to retinal in each helix.

The preprocessing pipeline operates as follows:

\begin{enumerate}
  \item \textbf{Family classification:} Input sequences are classified as Type~I or Type~II based on sequence similarity to reference opsins using MMseqs2\cite{steinegger2017}.
  \item \textbf{Reference selection:} The most similar reference sequence with known GRN assignments is identified.
  \item \textbf{Sequence alignment:} Pairwise alignment against the reference using Biopython's\cite{cock2009} \texttt{pairwise2} module.
  \item \textbf{GRN transfer:} Positions are labeled according to the alignment, assigning GRN coordinates to each residue.
  \item \textbf{Graph construction:} Binding pocket residues (those with GRN positions in the reference graph) are extracted, and the family-specific edge topology is applied.
  \item \textbf{Feature generation:} Protein language model embeddings are computed for each node using Ankh-large.
\end{enumerate}


\subsection{Model and Training}
\label{sec:lambda-model-training}

LAMBDA uses a graph neural network that processes binding pocket graphs to predict $\lambda_\text{max}$ for multiple retinal conformations.

\begin{figure}[H]
  \centering
  \includegraphics[width=\textwidth]{\dir/fig_lambda_model.png}
  \caption[LAMBDA model architecture]{%
    LAMBDA model architecture. A binding pocket graph is processed by a GCN encoder with residual connections, then aggregated through position-aware attention pooling. Five regression heads predict $\lambda_\text{max}$ across retinal conformations and protonation states. Inference logic selects the appropriate prediction based on a \SI{400}{\nano\metre} protonation threshold.}
  \label{fig:lambda-model}
\end{figure}

\textbf{Input representation.} Each node in the graph corresponds to a binding pocket residue and carries two feature types: (1)~a positional encoding derived from the GRN coordinate, capturing the residue's structural location relative to retinal, and (2)~a 1536-dimensional embedding from Ankh-large, capturing evolutionary and biochemical context. The positional encoding is learned during training, allowing the model to discover which binding pocket locations matter most for spectral tuning.

\textbf{Message passing.} The encoder uses a Graph Convolutional Network\cite{kipf2017} (GCN) with residual connections to update node representations through neighborhood aggregation. The GCN layer propagates information between connected residues, integrating local interactions across the binding pocket.

\textbf{Pooling.} A position-aware attention pooling mechanism with 32 heads generates a global representation from node-level features. This mechanism uses the GRN positional encodings---one-hot encoding of the mapped binding pocket position encoded through an embedding layer---to compute attention weights over residue contributions, enabling the model to learn multiple complementary views of position-dependent importance.

\textbf{Multi-task output.} The pooled representation feeds into five regression heads that predict $\lambda_\text{max}$ across retinal conformations and protonation states. For both 11-\textit{cis} and all-\textit{trans} retinal, two heads operate in parallel: one predicts $\lambda_\text{max}$ for protonated Schiff base states only ($\lambda_\text{max} > \SI{400}{\nano\metre}$), while the other predicts $\lambda_\text{max}$ across the full spectral range including deprotonated states. A fifth head predicts $\lambda_\text{max}$ for deprotonated Schiff base (UV-absorbing states, $\lambda_\text{max} < \SI{400}{\nano\metre}$). Protonation state is classified by a threshold at \SI{400}{\nano\metre}, chosen based on the bimodal distribution of $\lambda_\text{max}$ values in the training data: opsins with $\lambda_\text{max}$ below this boundary are classified as having a deprotonated Schiff base, and the corresponding UV head prediction is used; otherwise the protonated-state head prediction is reported. All prediction heads share the same encoder---the same learned representation of binding pocket structure feeds all outputs. This shared-encoder architecture reflects the biological reality that a single binding pocket determines spectral properties across chromophore states, and enables generalization to additional retinal conformations (9-\textit{cis}, 13-\textit{cis}) as training data become available.

\textbf{Loss function.} Training uses a combined loss that sums mean squared error across all prediction tasks, with masking to handle missing labels (\eg Type~I opsins lack 11-\textit{cis} measurements). The full-range heads (which predict across both protonated and deprotonated states) receive half weight relative to the state-specific heads, as they serve primarily as a regularizer that encourages globally consistent predictions. The split at \SI{400}{\nano\metre} into separate protonated and UV heads allows the model to learn distinct distributions for each protonation state rather than fitting a single non-Gaussian distribution.

\textbf{Optimization.} The model is trained with a learning rate of $2 \times 10^{-4}$ using a ReduceLROnPlateau schedule that decays the rate to a minimum of $1 \times 10^{-7}$ when validation loss plateaus. A batch size of~2 is used; larger batch sizes consistently degraded learning, likely because the small dataset and high variance across opsin families benefit from the noisier gradient estimates of very small batches.

\textbf{Regularization.} To prevent overfitting, dropout is applied within the GCN encoder and attention pooling layers, weight decay on all parameters, and early stopping based on validation loss with a patience of 50 epochs.

\textbf{Data splitting.} The combined dataset is divided into training (80\%), validation (10\%), and test (10\%) sets using stratified sampling. Stratification is performed at two levels: by source dataset (VPOD, Inoue, hCRBPII) and by species within each dataset. The 31 dual-state opsins are assigned exclusively to the training split to maximize exposure to dual-state measurements. The remaining data are split to ensure representative sampling across opsin types and taxonomic groups. For species with fewer than 3 samples, random assignment is used to avoid stratification failures.

\textbf{Evaluation metrics.} Mean absolute error (MAE) in nanometers after denormalizing predictions to the original $\lambda_\text{max}$ scale, coefficient of determination ($R^2$), and the fraction of predictions within \SI{5}{\nano\metre} and \SI{10}{\nano\metre} of experimental values are reported. For protonation state, classification accuracy is reported.

\textbf{Normalization.} Target values are normalized to $[0, 1]$ using the observed ranges in training data: 11-\textit{cis} $\lambda_\text{max}$ (\SIrange{401}{611}{\nano\metre}), all-\textit{trans} $\lambda_\text{max}$ (\SIrange{401}{644}{\nano\metre}), and UV $\lambda_\text{max}$ (\SIrange{340}{399}{\nano\metre}).


\subsection{Opsin Atlas}
\label{sec:lambda-opsin-atlas}

A comprehensive sequence collection was assembled by mining the NCBI non-redundant protein database to achieve broad coverage of opsin diversity across all major subfamilies in both Type~I and Type~II families. A phylogenetically informed sampling strategy was designed using BLAST searches seeded from representative sequences of each major opsin subfamily. Each query was searched against NCBI~nr using BLASTp, retrieving up to 5,000 hits per query. Because queries from related subfamilies often retrieve overlapping sets of sequences, each protein was assigned to the subfamily of the query to which it had the highest sequence identity. This similarity-based classification supersedes NCBI annotations, which frequently use ``bacteriorhodopsin'' as a generic label for diverse microbial rhodopsins regardless of their phylogenetic placement---for example, 46\% of type~I sequences carry ``bacteriorhodopsin'' in their NCBI annotation, yet similarity-based classification distributes these across eight distinct families, reflecting their actual evolutionary relationships. All per-query results were then merged into unified Type~I and Type~II tables.

For type~I (microbial) opsins, 13 query sequences covering 10 functional subfamilies were used (\autoref{tab:type1-queries}).

\begin{table}[tb]
  \caption[Type~I opsin query sequences for the Opsin Atlas]{Type~I (microbial) opsin query sequences for the Opsin Atlas.}
  \label{tab:type1-queries}
  \centering
  \begin{tabular}{lll}
    \toprule
    Subfamily & Query & Accession \\
    \midrule
    Proton pump & Bacteriorhodopsin (\textit{H.~salinarum}) & P02945 \\
    Proton pump & Archaerhodopsin-1 (\textit{Halorubrum} sp.) & P69051 \\
    Proton pump & Archaerhodopsin-2 (\textit{Halobacterium} sp.\ aus-2) & P29563 \\
    Chloride pump & Halorhodopsin (\textit{H.~salinarum}) & P0DMH7 \\
    Sensory rhodopsin~I & SRI (\textit{H.~salinarum}) & P0DMH8 \\
    Sensory rhodopsin~II & SRII (\textit{N.~pharaonis}) & P42196 \\
    Cation channel & Channelrhodopsin-1 (\textit{C.~reinhardtii}) & A0A2K3CXC9 \\
    Cation channel & Channelrhodopsin-2 (\textit{C.~reinhardtii}) & Q8RUT8 \\
    Anion channel & GtACR1 (\textit{G.~theta}) & L1JRS2 \\
    Green-absorbing PR & Proteorhodopsin (SAR86) & Q9F7P4 \\
    Blue-absorbing PR & Proteorhodopsin (HOT75) & Q9AFF7 \\
    Heliorhodopsin & HeR (metagenome) & A0A2P2C3K4 \\
    Xanthorhodopsin & Xanthorhodopsin (\textit{S.~ruber}) & Q2S2F8 \\
    \bottomrule
  \end{tabular}
\end{table}

For Type~II (animal) opsins, 14 query sequences covering 13 subfamilies were used (\autoref{tab:type2-queries}).

\begin{table}[tb]
  \caption[Type~II opsin query sequences for the Opsin Atlas]{Type~II (animal) opsin query sequences for the Opsin Atlas.}
  \label{tab:type2-queries}
  \centering
  \begin{tabular}{lll}
    \toprule
    Subfamily & Query & Accession \\
    \midrule
    Rod opsin & Rhodopsin (\textit{Bos taurus}) & P02699 \\
    Rod opsin & Rhodopsin (\textit{H.~sapiens}) & P08100 \\
    SWS1 cone opsin & OPN1SW (\textit{H.~sapiens}) & P03999 \\
    MWS cone opsin & OPN1MW (\textit{H.~sapiens}) & P04001 \\
    LWS cone opsin & OPN1LW (\textit{H.~sapiens}) & P04000 \\
    Encephalopsin (OPN3) & OPN3 (\textit{H.~sapiens}) & Q9H1Y3 \\
    Melanopsin (OPN4) & OPN4 (\textit{H.~sapiens}) & Q9UHM6 \\
    Neuropsin (OPN5) & OPN5 (\textit{H.~sapiens}) & Q6U736 \\
    Parapinopsin & Parapinopsin (\textit{I.~punctatus}) & O42266 \\
    Pinopsin & Pinopsin (\textit{G.~gallus}) & P51475 \\
    Peropsin & Peropsin (\textit{H.~sapiens}) & O14718 \\
    RGR & RGR (\textit{H.~sapiens}) & P47804 \\
    TMT opsin & TMT opsin (\textit{D.~rerio}) & R9R6C7 \\
    VA opsin & VA opsin (\textit{O.~masou}) & O13018 \\
    \bottomrule
  \end{tabular}
\end{table}

The retrieved sequences underwent quality filtering. Sequences exceeding 500 residues (likely multi-domain proteins or fusion constructs) were removed. To eliminate redundancy while preserving phylogenetic diversity, exact sequence duplicates were removed and cases where the same gene from the same species appeared under multiple accession numbers were filtered, while retaining orthologous sequences from different species. Most critically, each sequence was validated through the GRN annotation pipeline, retaining only sequences that (1)~contained the conserved Schiff base lysine at the expected GRN position (7.43 for Type~II, 7.50 for Type~I), and (2)~achieved sufficient GRN coverage to generate the input graphs for LAMBDA.

For prediction, LAMBDA was applied with output heads matched to each opsin type's native chromophore configuration. Type~I opsins, which bind all-\textit{trans} retinal, received predictions for $\lambda_\text{max}^\text{AT}$. Type~II opsins received predictions for their dark-state chromophore ($\lambda_\text{max}^\text{11-cis}$), but $\lambda_\text{max}^\text{AT}$ was additionally predicted for all type~II sequences. This dual prediction for type~II opsins---though training data for their all-\textit{trans} state is limited to the 31 dual-state sequences---enables estimation of spectral shifts upon photoactivation, a property critical for optogenetic applications. All data management, sequence processing, and GRN annotation were performed using ProtOS.


\section{Results}
\label{sec:lambda-results}

LAMBDA was evaluated on the held-out test set (10\% of data, stratified by dataset and species). Performance is reported for each prediction target alongside published results from family-specific methods where available.

\begin{table}[tb]
  \caption[LAMBDA performance compared with family-specific methods]{LAMBDA performance on held-out test set compared with family-specific methods.}
  \label{tab:lambda-results}
  \centering
  \begin{tabular}{lllll}
    \toprule
    Metric & LAMBDA & OPTICS & Inoue et~al. & RhoMax \\
    \midrule
    \multicolumn{5}{l}{\textbf{MAE $\pm$ std (nm)}} \\
    \quad Type~II (11-\textit{cis}) & \textbf{5.18 $\pm$ 0.82} & 5.49 & -- & -- \\
    \quad Type~I (all-\textit{trans}) & \textbf{6.86 $\pm$ 0.89} & -- & 7.80 & 6.83$^\dagger$ \\
    \quad hCRBPII (all-\textit{trans}, $n=6$) & \textbf{5.84 $\pm$ 1.13} & -- & -- & -- \\
    \midrule
    \multicolumn{5}{l}{\textbf{$R^2$}} \\
    \quad Type~II (11-\textit{cis}) & \textbf{0.972} & 0.964 & -- & -- \\
    \quad Type~I (all-\textit{trans}) & \textbf{0.894} & -- & -- & -- \\
    \quad hCRBPII (all-\textit{trans}, $n=6$) & \textbf{0.978} & -- & -- & -- \\
    \midrule
    \multicolumn{5}{l}{\textbf{Other}} \\
    \quad Protonation acc. & 98.3\% & -- & -- & -- \\
    \quad Within \SI{5}{\nano\metre} (11c) & 77.6\% & -- & -- & -- \\
    \quad Within \SI{5}{\nano\metre} (AT) & 52.7\% & -- & -- & -- \\
    \quad Within \SI{10}{\nano\metre} (11c) & 93.9\% & -- & -- & -- \\
    \quad Within \SI{10}{\nano\metre} (AT) & 83.9\% & -- & -- & -- \\
    \bottomrule
    \multicolumn{5}{l}{\footnotesize $^\dagger$Median absolute error; all other values are mean absolute error.}
  \end{tabular}
\end{table}

Evaluation protocols differ across methods. LAMBDA reports held-out test set performance (10\% stratified split). OPTICS uses $k$-fold cross-validation on VPOD~WDS ($n=1{,}211$) with amino acid property encoding. Inoue et~al.\ report within-family evaluation on their full dataset of 884 type~I sequences. RhoMax reports median absolute error across 4 family-aware cross-validation splits on 884 type~I sequences (mean AE~$= \SI{10.45}{\nano\metre}$) and requires structures as input. Despite these protocol differences, all methods operate on comparable dataset sizes and the reported accuracies are broadly comparable. The hCRBPII test set contains only 6 samples, limiting statistical power.

\begin{figure}[H]
  \centering
  \includegraphics[width=\textwidth]{\dir/fig_lambda_results.jpg}
  \caption[LAMBDA prediction accuracy]{%
    LAMBDA prediction accuracy on the held-out test set. Predicted vs.\ measured $\lambda_\text{max}$ for (A)~type~I opsins (all-\textit{trans}) and (B)~type~II opsins (11-\textit{cis}).}
  \label{fig:lambda-results}
\end{figure}

LAMBDA achieved a mean absolute error of $\SI{5.18}{\nano\metre} \pm \SI{0.82}{\nano\metre}$ for type~II opsins (11-\textit{cis} retinal, $n=119$) and $\SI{6.86}{\nano\metre} \pm \SI{0.89}{\nano\metre}$ for type~I opsins (all-\textit{trans} retinal, $n=87$) on the held-out test set (\autoref{fig:lambda-results}). These values reflect the model's actual output, using the protonation-state classification described in Methods to select between head predictions. The model correctly classified protonation state with 98.3\% accuracy. For hCRBPII (42 training, 3 validation, 6 test samples), the model achieved an MAE of $\SI{5.84}{\nano\metre} \pm \SI{1.13}{\nano\metre}$ ($R^2 = 0.978$)---comparable to opsin performance despite the fundamentally different lipocalin fold. The small test set limits statistical confidence, but the result demonstrates that the binding domain graph framework accommodates non-opsin folds when training examples and appropriate GRN mappings are available.

These results place LAMBDA's accuracy in the same range as the best family-specific methods while predicting across chromophore conformations and protein families from a unified model. That joint training does not degrade within-family accuracy suggests that spectral tuning principles transfer across folds and that the cross-family position mapping captures genuine structural equivalences rather than introducing noise. A systematic underestimation of far-red absorption maxima, where the model saturates near \SI{610}{\nano\metre}, represents the primary limitation and is addressed in the Discussion.

The trained model was applied to 47,700 opsin sequences assembled from NCBI to produce the Opsin Atlas, spanning 20,061 Type~I opsins across 10 subfamilies and 27,639 Type~II opsins across 12 subfamilies.

\begin{sidewaysfigure}
  \centering
  \includegraphics[width=\textheight]{\dir/fig_opsin_atlas.jpg}
  \caption[Opsin Atlas spectral landscape]{%
    Opsin Atlas spectral landscape. Predicted $\lambda_\text{max}$ distributions for (A)~20,061 type~I opsins (all-\textit{trans}), (B)~27,639 Type~II opsins (11-\textit{cis}), and (C)~absolute spectral shift $|\Delta\lambda|$ for Type~II opsins (protonated states only).}
  \label{fig:opsin-atlas}
\end{sidewaysfigure}

\textbf{Type~I opsins} (\autoref{fig:opsin-atlas}A). Predictions of $\lambda_\text{max}^\text{AT}$ for native all-\textit{trans} retinal show a mean of $\SI{519.5}{\nano\metre} \pm \SI{28.1}{\nano\metre}$ (range: \SIrange{436}{644}{\nano\metre}) across 20,061 sequences. The aggregate distribution approximates a single Gaussian centered near \SI{520}{\nano\metre}, reflecting the relatively homogeneous spectral tuning of microbial rhodopsins around their shared proton-pumping or sensory functions. Within this envelope, individual subfamilies occupy characteristic spectral ranges: proton pump: $\SI{532.4}{\nano\metre} \pm \SI{23.8}{\nano\metre}$ ($n=5{,}108$, 25.5\%), heliorhodopsin: $\SI{498.5}{\nano\metre} \pm \SI{37.6}{\nano\metre}$ ($n=4{,}993$, 24.9\%), green-absorbing proteorhodopsin: $\SI{520.7}{\nano\metre} \pm \SI{16.3}{\nano\metre}$ ($n=4{,}942$, 24.6\%), xanthorhodopsin: $\SI{527.3}{\nano\metre} \pm \SI{12.5}{\nano\metre}$ ($n=4{,}304$, 21.5\%), blue-absorbing proteorhodopsin: $\SI{537.0}{\nano\metre} \pm \SI{20.7}{\nano\metre}$ ($n=310$, 1.5\%; note that the predicted mean for this subfamily is redder than for green-absorbing proteorhodopsin---the model inverts their relative spectral order, likely reflecting the small sample size and sequence-similarity-based subfamily assignment rather than measured $\lambda_\text{max}$), cation channel: $\SI{486.1}{\nano\metre} \pm \SI{25.6}{\nano\metre}$ ($n=120$, 0.6\%), chloride pump: $\SI{525.6}{\nano\metre} \pm \SI{16.1}{\nano\metre}$ ($n=103$, 0.5\%), sensory rhodopsin~II: $\SI{508.5}{\nano\metre} \pm \SI{25.3}{\nano\metre}$ ($n=89$, 0.4\%), sensory rhodopsin~I: $\SI{509.0}{\nano\metre} \pm \SI{24.5}{\nano\metre}$ ($n=86$, 0.4\%), and anion channel: $\SI{478.3}{\nano\metre} \pm \SI{15.7}{\nano\metre}$ ($n=6$, $<$0.1\%). Four subfamilies---proton pumps, heliorhodopsins, green-absorbing proteorhodopsins, and xanthorhodopsins---together account for 96.5\% of all Type~I sequences. Proteorhodopsins show a characteristic bimodal distribution, with distinct blue-absorbing and green-absorbing sub-populations reflecting ecological adaptation to different ocean depths. Heliorhodopsins span the widest spectral range but are blue-shifted relative to the classical proton pumps.

\textbf{Type~II opsins} (\autoref{fig:opsin-atlas}B). In contrast to the unimodal Type~I distribution, the 11-\textit{cis} dark-state predictions for 27,639 Type~II opsins (mean $\SI{467.0}{\nano\metre} \pm \SI{42.9}{\nano\metre}$, range \SIrange{344}{583}{\nano\metre}) resolve into multiple distinct peaks corresponding to the spectral classes of animal vision. Per-subfamily statistics are: rod opsin: $\SI{481.7}{\nano\metre} \pm \SI{24.0}{\nano\metre}$ ($n=5{,}321$, 19.3\%), neuropsin: $\SI{459.8}{\nano\metre} \pm \SI{36.7}{\nano\metre}$ ($n=4{,}731$, 17.1\%), encephalopsin: $\SI{465.7}{\nano\metre} \pm \SI{21.5}{\nano\metre}$ ($n=4{,}317$, 15.6\%), cone SWS1: $\SI{413.0}{\nano\metre} \pm \SI{42.3}{\nano\metre}$ ($n=3{,}237$, 11.7\%), melanopsin: $\SI{495.2}{\nano\metre} \pm \SI{24.6}{\nano\metre}$ ($n=2{,}584$, 9.3\%), cone MWS: $\SI{532.4}{\nano\metre} \pm \SI{31.3}{\nano\metre}$ ($n=2{,}473$, 8.9\%), RGR: $\SI{456.0}{\nano\metre} \pm \SI{25.3}{\nano\metre}$ ($n=2{,}041$, 7.4\%), peropsin: $\SI{448.3}{\nano\metre} \pm \SI{20.5}{\nano\metre}$ ($n=1{,}449$, 5.2\%), parapinopsin: $\SI{430.1}{\nano\metre} \pm \SI{33.6}{\nano\metre}$ ($n=1{,}255$, 4.5\%), VA opsin: $\SI{436.6}{\nano\metre} \pm \SI{32.4}{\nano\metre}$ ($n=102$, 0.4\%), cone LWS: $\SI{486.8}{\nano\metre} \pm \SI{26.3}{\nano\metre}$ ($n=64$, 0.2\%), and pinopsin: $\SI{453.1}{\nano\metre} \pm \SI{34.2}{\nano\metre}$ ($n=64$, 0.2\%). The dominant peak near \SI{500}{\nano\metre} is formed by rod opsins, the primary dim-light photoreceptors. A second major cluster in the UV-blue range below \SI{430}{\nano\metre} comprises cone SWS1 opsins and parapinopsin, which detect short wavelengths for color discrimination and circadian entrainment. Cone MWS opsins form a distinct peak near \SI{530}{\nano\metre}, while melanopsin clusters near \SI{495}{\nano\metre}. Non-visual opsins---encephalopsin and neuropsin---populate the intermediate blue-green range. This multimodal structure reflects the evolutionary diversification of animal opsins into specialized spectral channels for color vision, scotopic sensitivity, and non-visual photoreception.

LAMBDA also predicts $\lambda_\text{max}^\text{AT}$ for all Type~II opsins---the absorption maximum with all-\textit{trans} retinal, as occurs during photoactivation or stably in bistable opsins. The $\lambda_\text{max}^\text{AT}$ distribution is systematically red-shifted relative to 11-\textit{cis} predictions and collapses from the multimodal 11-\textit{cis} pattern into a bimodal shape: a primary peak near \SI{520}{\nano\metre} dominated by rod and long-wavelength cone opsins, and a secondary shoulder near \SI{490}{\nano\metre} comprising SWS1, neuropsin, RGR, and encephalopsin. This dual-state analysis applies only to Type~II opsins; the model produces 11-\textit{cis} predictions for Type~I sequences, but these lack biological basis and training signal and are omitted from the atlas.

For Type~II opsins, predictions for both chromophore states enable estimation of the spectral shift upon activation. $\Delta\lambda$ is computed using the protonated Schiff base predictions only ($\lambda_\text{max} > \SI{400}{\nano\metre}$), excluding UV-absorbing deprotonated states---the goal is to isolate the spectral shift arising from binding pocket interactions with retinal, not the large blue shift that accompanies Schiff base deprotonation (which moves any opsin into the UV regardless of pocket composition). These $\Delta\lambda$ values are derived quantities: the all-\textit{trans} prediction for Type~II opsins is trained on only 31 dual-state sequences and has not been independently validated, so the spectral shift estimates should be interpreted as indicative rather than quantitative. The signed difference $\Delta\lambda = \lambda_\text{max}^\text{AT} - \lambda_\text{max}^\text{11-cis}$ ranges from $-108$ to $+\SI{148}{\nano\metre}$ (mean $+\SI{18.8}{\nano\metre} \pm \SI{33.0}{\nano\metre}$; \autoref{fig:opsin-atlas}C), with 23\% of predictions showing a blue shift (negative $\Delta\lambda$). Per-subfamily means reveal consistent differences: VA opsin ($+\SI{47.5}{\nano\metre} \pm \SI{28.4}{\nano\metre}$), cone SWS1 ($+\SI{41.7}{\nano\metre} \pm \SI{30.7}{\nano\metre}$), RGR ($+\SI{34.5}{\nano\metre} \pm \SI{22.1}{\nano\metre}$), and peropsin ($+\SI{24.8}{\nano\metre} \pm \SI{18.6}{\nano\metre}$) show the largest red shifts. Rod opsin ($+\SI{17.7}{\nano\metre} \pm \SI{20.0}{\nano\metre}$), neuropsin ($+\SI{17.5}{\nano\metre} \pm \SI{28.7}{\nano\metre}$), and cone LWS ($+\SI{5.2}{\nano\metre} \pm \SI{15.8}{\nano\metre}$) show modest shifts. Cone MWS is the only subfamily with a negative mean ($-\SI{37.9}{\nano\metre} \pm \SI{29.9}{\nano\metre}$), indicating that these opsins are predicted to blue-shift upon isomerization to all-\textit{trans}. Melanopsin ($+\SI{21.6}{\nano\metre} \pm \SI{43.4}{\nano\metre}$) shows the widest spread, spanning both directions.

The atlas is available as a supplementary resource, providing predicted $\lambda_\text{max}$ values for both chromophore states, spectral separation estimates, GRN annotations, and taxonomic metadata for each sequence.


\section{Discussion}
\label{sec:lambda-discussion}

LAMBDA demonstrates that binding domain analysis---representing the chromophore environment as a graph aligned on retinal---enables spectral prediction across protein families from a single model. Where OPTICS and the Inoue model extract features from amino acid sequences, and RhoMax uses structure-derived graphs limited to Type~I opsins, LAMBDA defines graph nodes by their spatial relationship to the chromophore rather than by sequence position. GRN systems make this a structure-based model that accepts sequence as input.

Accuracy comparable to the best family-specific methods (\SI{5.18}{\nano\metre} MAE for Type~II, \SI{6.86}{\nano\metre} for Type~I) is achieved while simultaneously predicting multiple chromophore states from a unified model---a capability that sequence-based approaches, which are inherently fold- and conformation-specific, cannot provide. The improvement over OPTICS' sequence-based approach (\SI{5.49}{\nano\metre} cross-validated) suggests that binding pocket structure provides more robust features than lineage-specific sequence patterns. Within this representation, pLM embeddings (Ankh-large, 1536 dimensions) describe what occupies each binding pocket position while the graph describes where those positions are relative to retinal---the model depends on both, but the graph structure is what enables cross-family learning.

The most informative limitation is LAMBDA's systematic underestimation of far-red absorption maxima. The model saturates at approximately \SI{610}{\nano\metre}, compressing the \SIrange{590}{650}{\nano\metre} range even when these samples are included in training. This reflects physics rather than architecture: the relationship $E = hc/\lambda$ means that energy gaps shrink dramatically at long wavelengths, and at these small scales spectral tuning becomes dominated by subtle local effects the model cannot detect---precise positioning of partial charges, fine details of hydrogen bonding, electronic polarization---that produce disproportionately large wavelength shifts. The binding pocket graph captures residue identity and spatial arrangement, but not the electrostatic precision required to resolve \SI{0.03}{\electronvolt} differences in excitation energy. I believe the features that distinguish a \SI{600}{\nano\metre} opsin from a \SI{640}{\nano\metre} opsin may require explicit quantum mechanical modeling. For optogenetic engineering, LAMBDA can identify candidates as deeply red-shifted but cannot rank them within that regime---precise spectral positioning above \SI{590}{\nano\metre} requires either experimental characterization or hybrid approaches, e.g., combining machine learning with QM/MM calculations.

More generally, the model cannot generalize to novel folds without training examples, and properties beyond $\lambda_\text{max}$ remain outside its scope.

Despite these limitations, the atlas enables computational screening across the full spectral range. LAMBDA is the first method to predict the spectral separation between dark and activated states systematically. The atlas highlights specific candidates for optogenetic applications: a heliorhodopsin from \textit{Candidatus} Kerfeldbacteria (PIS41810) is predicted as the most red-shifted Type~I opsin at \SI{644}{\nano\metre}, deep into the optical window for tissue penetration; an SWS1 opsin from \textit{Hylia prasina} (NWU40863) as the most blue-shifted Type~II opsin at \SI{344}{\nano\metre}; and for bidirectional control, a peropsin from the beluga whale \textit{Delphinapterus leucas} (XP\_022422838) shows the largest predicted spectral separation at $+\SI{148}{\nano\metre}$ (\SI{458}{\nano\metre} dark state, \SI{607}{\nano\metre} activated), followed by melanopsins from \textit{Sturnira hondurensis} ($+\SI{146}{\nano\metre}$) and \textit{Phyllostomus discolor} ($+\SI{143}{\nano\metre}$). The ability to predict how mutations affect both chromophore states enables engineering strategies that optimize spectral separation, not just dark-state absorption---candidates that would be impractical to discover through experimental screening alone.

Beyond opsin families, the hCRBPII results demonstrate that LAMBDA's framework extends to entirely different protein folds. Despite the fundamentally different lipocalin architecture, the model achieves accuracy comparable to opsin predictions when training examples are available---though with $n=6$ samples in the test split this result is statistically weak. The boundary is principled: extending to a new fold requires defining its binding pocket graph and providing representative training data, rather than building a separate model.

An open limitation is the role of solvent in spectral tuning. In opsins, the binding pocket is largely occluded from bulk water, and the model may implicitly learn solvation effects through correlations with surrounding residues. In solvent-exposed binding pockets, water molecules directly contact the chromophore and modulate its absorption in ways that depend on occupancy and orientation rather than protein sequence. For proteins with open binding sites, this remains a source of prediction error that neither additional sequence data nor larger embeddings are likely to eliminate without explicit solvation modeling.

When structures are available, binding pocket graphs can be derived directly. For the sequence-only path---which enables the Opsin Atlas and any large-scale application---LAMBDA depends on standardized positional annotation: without MOGRN coordinates for microbial rhodopsins, the graph representation that enables cross-family learning from sequence would not exist; without the chromophore-centered mapping between MOGRN and Ballesteros--Weinstein positions, Type~I and Type~II opsins could not share graph nodes. This dependency is also the source of extensibility---any protein family with a retinal-binding pocket and an appropriate GRN system can be incorporated. Proteins engineered to preserve the binding pocket while redesigning other regions retain predictable spectral properties, because the same pocket determines absorption regardless of what surrounds it.
